<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>í•™êµ Q&A í”Œë«í¼</title>

<style>
  body {
    font-family: Arial, sans-serif;
    background: #f4f6f8;
    margin: 0;
    padding: 0;
  }

  .header {
    background: #2c3e50;
    color: white;
    padding: 15px;
    text-align: center;
    font-size: 22px;
  }

  .container {
    padding: 20px;
  }

  input, select, textarea, button {
    width: 100%;
    margin-top: 8px;
    padding: 10px;
    font-size: 16px;
    border-radius: 5px;
  }

  button {
    background: #2c3e50;
    color: white;
    border: none;
    cursor: pointer;
  }

  button:hover {
    background: #1f2a38;
  }

  .question {
    background: white;
    border-radius: 8px;
    padding: 12px;
    margin-top: 8px;
    font-weight: bold;
  }

  .solved {
    background-color: #d4edda;
    color: #155724;
  }

  .unsolved {
    background-color: #f8d7da;
    color: #721c24;
  }

  /* ë°˜ì‘í˜• ì ìš© */
  @media (max-width: 768px) {
    .header {
      font-size: 20px;
      padding: 12px;
    }
  }

</style>
</head>
<body>

<div class="header">í•™êµ Q&A í”Œë«í¼</div>

<div class="container">

  <!-- ë¡œê·¸ì¸ -->
  <div id="auth">
    <h3>ë¡œê·¸ì¸ / íšŒì›ê°€ì…</h3>
    ì´ë©”ì¼
    <input type="email" id="email" placeholder="ì´ë©”ì¼ ì…ë ¥">
    ë¹„ë°€ë²ˆí˜¸
    <input type="password" id="password" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥">
    ë‹‰ë„¤ì„
    <input type="text" id="nickname" placeholder="ë‹‰ë„¤ì„ ì…ë ¥">
    <button onclick="signup()">íšŒì›ê°€ì…</button>
    <button onclick="login()">ë¡œê·¸ì¸</button>
    <hr>
  </div>

  <!-- ì§ˆë¬¸ ì‘ì„± -->
  <div id="questionForm" style="display:none;">
    <h3>ì§ˆë¬¸ ì‘ì„±</h3>
    ê³¼ëª©
    <select id="subject">
      <option>ìˆ˜í•™</option>
      <option>ì˜ì–´</option>
      <option>ê³¼í•™</option>
      <option>ê¸°íƒ€</option>
    </select>
    ì§ˆë¬¸ ë‚´ìš©
    <textarea id="questionText" rows="3" placeholder="ì§ˆë¬¸ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
    <button onclick="addQuestion()">ì§ˆë¬¸ ë“±ë¡ (+10P)</button>
    <hr>
  </div>

  <!-- ì§ˆë¬¸ ëª©ë¡ -->
  <div id="questionsBoard">
    <h3>ì§ˆë¬¸ ëª©ë¡</h3>
    <div id="questions"></div>
  </div>

</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js";
  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-auth.js";
  import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyC9y33YK_3b5NMfAk6dZi2jDMIi_dDXklQ",
    authDomain: "site4school-6affe.firebaseapp.com",
    projectId: "site4school-6affe",
    storageBucket: "site4school-6affe.firebasestorage.app",
    messagingSenderId: "527337035288",
    appId: "1:527337035288:web:290da151584a31eb90d56d",
    measurementId: "G-PLB6VXX955"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  async function signup() {
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;
    try {
      await createUserWithEmailAndPassword(auth, email, password);
      alert("íšŒì›ê°€ì… ì™„ë£Œ! ë¡œê·¸ì¸ í•´ì£¼ì„¸ìš”.");
    } catch (err) {
      alert(err.message);
    }
  }

  async function login() {
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;
    try {
      await signInWithEmailAndPassword(auth, email, password);
      alert("ë¡œê·¸ì¸ ì„±ê³µ!");
      document.getElementById("auth").style.display = "none";
      document.getElementById("questionForm").style.display = "block";
      loadQuestions();
    } catch (err) {
      alert(err.message);
    }
  }

  async function addQuestion() {
    const text = document.getElementById("questionText").value;
    const subject = document.getElementById("subject").value;
    await addDoc(collection(db, "questions"), {
      subject: subject,
      text: text,
      status: "unsolved"
    });
    document.getElementById("questionText").value = "";
    loadQuestions();
  }

  async function loadQuestions() {
    const querySnapshot = await getDocs(collection(db, "questions"));
    const container = document.getElementById("questions");
    container.innerHTML = "";
    querySnapshot.forEach((doc) => {
      const q = doc.data();
      const div = document.createElement("div");
      div.className = "question " + q.status;
      div.innerText = `ğŸ”¹ ${q.subject} â€” ${q.text}`;
      container.appendChild(div);
    });
  }
</script>

</body>
</html>
